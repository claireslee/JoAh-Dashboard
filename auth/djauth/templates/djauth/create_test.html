<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title> joah project </title>

    {%load static%} 
  
    <link rel="stylesheet" type="text/css" href="{% static 'djauth/teacherDash.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  
    <link href="{% static 'djauth/mainpage.css' %}" rel="stylesheet">
    <style>
      #answer-fields {
        text-align: center;
      }
      
      #answer-fields label {
        display: inline-block;
        margin-right: 10px;
      }
      body{
        background-color: #eaeff1;
      }
      .create-test {
        display: block;
        width: 50%;
        padding: 10px;
        text-align: center;
        background-color: rgba(192, 146, 242, 0.8);
        border: none;
        border-radius: 10px;
        color: #fff;
        font-weight: 500;
        text-decoration: none;
        transition: background-color 0.3s ease;
        height: 40px;
        vertical-align: middle;
         /* Add this line to center-align the button */
      }
      
      .create-test:hover {
        background-color: rgb(170, 150, 237);

      }
      .create-answer {
        display: block;
        width: 50%;
        padding: 10px;
        text-align: center;
        background-color: rgba(192, 146, 242, 0.8);
        border: none;
        border-radius: 10px;
        color: #fff;
        font-weight: 500;
        text-decoration: none;
        transition: background-color 0.3s ease;
        height: 40px;
        vertical-align: middle;
         /* Add this line to center-align the button */
      }
      
      .create-answer:hover {
        background-color: rgb(170, 150, 237);

      }
      
      .form-group {
        display: flex;
        width: 75%;
        flex-wrap: wrap;
        justify-content: flex-start;
        gap: 10px;
        margin-top: 10px;
        margin-left: 40px; /* Add margin-left to create space */
        margin-right: 40px;
        position: relative;
        
      }

      .create-pdf {
        
        font-family: Montserrat;
        width: 50%;
        padding: 20px;
        margin-top: 20px;
        background-color: rgba(255, 255, 255, 0.92);
        border-radius: 30px;
        position: relative;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .form-group input[type="number"] {
        outline: 1px solid #ced4da;
      }
    </style>
  
  </head>
  
  <header>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
          <div>
              <ul class="navbar-nav">
                  <a class="logo" href="/mainpage"> <img src="{% static 'djauth/media/joah-logo.png' %}" style="width:95px; height:55px"> </a>
                  <li class="nav-item"><a class="nav-link" href="/teacherAnnouncement"> Announcements </a></li>
                  <li class="nav-item"><a class="nav-link" href="/examList"> Custom Test</a></li>
                  <li class="nav-item"><a class="nav-link" href="/fullStudentList"> View Students </a></li>
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="inquiriesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Inquiries</a>
                    <ul class="dropdown-menu" aria-labelledby="inquiriesDropdown">
                        <li><a class="dropdown-item" href="/newTeacher">Teacher Inquiries</a></li>
                        <li><a class="dropdown-item" href="/generalInquiries">General Inquiries</a></li>
                    </ul>
                </li>
                  <li class="nav-item"><a class="nav-link" href="/exam_list"> PDF Test </a></li>

                
                  {% if user.is_authenticated %}
                      <li class="nav-item"><a class="nav-link" href="/dash"> Dashboard </a></li>
                      {%endif%}
              </ul>
          </div>
          <div>
              <ul class="navbar-nav">
                  {% if user.is_authenticated %}
                  <span class="navbar-text"> Welcome to JoAh, {{user.username}}! | </span>
                  <li class="nav-item"><a class="nav-link" href="/logout"> logout </a></li>
                  {% else %}
                  <li class="nav-item"><a class="nav-link" href="/login"> login </a></li>
              {%endif%}
      </div>
  </nav>
</header>


<center>
<body>
  <div class="create-pdf">
    <form method="post" enctype="multipart/form-data" novalidate>
      {% csrf_token %}
      
      <div class="form-group">
          <label for="{{ form.num_questions.id_for_label }}">{{ form.num_questions.label }}</label>
          {{ form.num_questions }}
      </div>
      
      <div class="form-group">
          <label for="{{ form.pdf.id_for_label }}">{{ form.pdf.label }}</label>
          {{ form.pdf }}
      </div>
      
      <div class="form-group">
          <label for="{{ form.file_name.id_for_label }}">{{ form.file_name.label }}</label>
          {{ form.file_name }}
      </div>
      
      {{ form.answers }}
      
      <button type="button" class="create-answer" id="create-answer-fields-btn">Create Answer Fields</button><br>
      <div id="answer-fields"></div><br>
      <button class="create-test" type="submit">Create Test</button>
  </form>
</div>
</center>
  {% block scripts %}
  <script>
    
    const createAnswerFieldsBtn = document.querySelector('#create-answer-fields-btn');
    const answerFieldsContainer = document.querySelector('#answer-fields');
    console.log(createAnswerFieldsBtn);
    console.log(answerFieldsContainer);
    
    createAnswerFieldsBtn.addEventListener('click', () => {
      const numQuestionsInput = document.querySelector('#id_num_questions');
      const numQuestions = numQuestionsInput.value;
      
      if (numQuestions && !isNaN(numQuestions)) {
        answerFieldsContainer.innerHTML = '';
        
        for (let i = 1; i <= numQuestions; i++) {
          const label = document.createElement('label');
          label.innerHTML = `Answer for Question ${i}:`;
  
          const radioA = createRadioButton(`q${i}_answer`, 'A', false);
          const radioB = createRadioButton(`q${i}_answer`, 'B', false);
          const radioC = createRadioButton(`q${i}_answer`, 'C', false);
          const radioD = createRadioButton(`q${i}_answer`, 'D', false);
          
          answerFieldsContainer.appendChild(label);
          answerFieldsContainer.appendChild(radioA);
          answerFieldsContainer.appendChild(radioB);
          answerFieldsContainer.appendChild(radioC);
          answerFieldsContainer.appendChild(radioD);
          
          answerFieldsContainer.appendChild(document.createElement('br'));
        }
      }
    });

    // Get a reference to the form element
const form = document.querySelector('form');
console.log("Event listener added"); 


// Add an event listener to the form submission event
form.addEventListener('submit', (event) => {
  const numQuestionsInput = document.querySelector('#id_num_questions');
  const numQuestions = numQuestionsInput.value;
  console.log("submit pressed")
  event.preventDefault();

  const radioButtons = document.querySelectorAll('input[type="radio"]');
  const answers = {};
  let isAnyQuestionUnanswered = false;

  radioButtons.forEach((radio) => {
    const questionNum = radio.name.split('_')[0];
    console.log(questionNum)
    const selectedAnswer = radio.checked ? radio.value : null;

    if (selectedAnswer) {
      console.log(selectedAnswer)
      answers[questionNum] = selectedAnswer;
    } 
  });

  

  const answersJson = JSON.stringify(answers);
  console.log(answersJson)
  const answersField = document.querySelector('#id_answers');
  answersField.value = answersJson;

  

  form.submit();
});

    
    function createRadioButton(name, value, checked) {
      const radio = document.createElement('input');
      radio.type = 'radio';
      radio.name = name;
      radio.value = value;
      radio.checked = checked;
      
      const label = document.createElement('label');
      label.innerHTML = value;
      label.appendChild(radio);
      
      return label;
    }
    
  const pdfInput = document.querySelector('#id_pdf');
  const nameInput = document.querySelector('#id_name');
  pdfInput.addEventListener('change', (event) => {
    const pdfFile = event.target.files[0];
    
});
</script>
{% endblock %}

</body>


